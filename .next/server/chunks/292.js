exports.id=292,exports.ids=[292],exports.modules={7197:(e,a,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},9265:(e,a,t)=>{Promise.resolve().then(t.bind(t,9540))},8069:(e,a,t)=>{"use strict";t.d(a,{Dr:()=>U,IM:()=>c,L6:()=>E,NJ:()=>A,Ni:()=>D,Pn:()=>I,UE:()=>m,W8:()=>y,_d:()=>N,_l:()=>L,a3:()=>v,gr:()=>C,j2:()=>u,jJ:()=>w,km:()=>S,ln:()=>f,oH:()=>g,pC:()=>T,qt:()=>s,sv:()=>p,uo:()=>R,wJ:()=>O,wz:()=>_,xu:()=>d,yC:()=>h});let r=["http://192.168.1.100:8000","http://localhost:8000"],n=null;async function o(){if(n)return n;for(let e of r)try{let a=new AbortController,t=setTimeout(()=>a.abort(),2e3),r=await fetch(`${e}/health`,{signal:a.signal});if(clearTimeout(t),r.ok)return console.log(`API d\xe9tect\xe9e sur: ${e}`),n=e,e}catch(a){console.log(`API non disponible sur: ${e}`)}return console.warn("Aucune API d\xe9tect\xe9e, utilisation de l'URL par d\xe9faut"),n="http://192.168.1.100:8000"}function s(){return n}async function i(e,a){let t=await o(),r=`${t}${e}`,n=await fetch(r,{...a,headers:{"Content-Type":"application/json",...a?.headers}});if(!n.ok)throw Error((await n.json().catch(()=>({detail:"Erreur inconnue"}))).detail||`Erreur ${n.status}`);return n.json()}async function l(e,a){let t=await o(),r=`${t}${e}`,n=await fetch(r,{method:"POST",body:a});if(!n.ok)throw Error((await n.json().catch(()=>({detail:"Erreur inconnue"}))).detail||`Erreur ${n.status}`);return n.json()}async function c(e=4){return i(`/api/tree?max_depth=${e}`)}async function y(){return i("/api/armoires")}async function p(e){return i(`/api/browse/${encodeURIComponent(e)}`)}async function d(e){return i("/api/armoires",{method:"POST",body:JSON.stringify({name:e})})}async function E(e,a){return i(`/api/create/${encodeURIComponent(e)}`,{method:"POST",body:JSON.stringify({name:a})})}async function u(e,a){let t=new FormData;return a.forEach(e=>t.append("files",e)),l(`/api/upload-multiple/${encodeURIComponent(e)}`,t)}function S(e,a){let t=a||n||"http://192.168.1.100:8000";return`${t}/api/download/${encodeURIComponent(e)}`}function T(e,a){let t=a||n||"http://192.168.1.100:8000";return`${t}/api/preview/${encodeURIComponent(e)}`}async function m(e,a){return i(`/api/rename/${encodeURIComponent(e)}`,{method:"PUT",body:JSON.stringify({new_name:a})})}async function _(e){return i(`/api/delete/${encodeURIComponent(e)}`,{method:"DELETE"})}async function R(e,a){return i(`/api/move/${encodeURIComponent(e)}`,{method:"PUT",body:JSON.stringify({destination_id:a})})}async function h(e,a){let t=new URLSearchParams({q:e});return a?.type&&t.append("type",a.type),a?.extension&&t.append("extension",a.extension),i(`/api/search?${t.toString()}`)}async function A(){return i("/api/tags")}async function f(e,a="#3b82f6"){return i("/api/tags",{method:"POST",body:JSON.stringify({name:e,color:a})})}async function I(e){return i(`/api/tags/${encodeURIComponent(e)}`,{method:"DELETE"})}async function C(e){return i(`/api/item/${encodeURIComponent(e)}/tags`)}async function O(e,a){return i(`/api/item/${encodeURIComponent(e)}/tags/${encodeURIComponent(a)}`,{method:"POST"})}async function w(e,a){return i(`/api/item/${encodeURIComponent(e)}/tags/${encodeURIComponent(a)}`,{method:"DELETE"})}async function g(e){return i(`/api/tags/${encodeURIComponent(e)}/items`)}async function L(){return i("/api/favorites")}async function v(e){return i(`/api/favorites/${encodeURIComponent(e)}`,{method:"POST"})}async function D(e){return i(`/api/favorites/${encodeURIComponent(e)}`,{method:"DELETE"})}async function U(){return i("/api/ocr/status")}async function N(e=25){return i(`/api/ocr/batch?limit=${e}`,{method:"POST"})}},9540:(e,a,t)=>{"use strict";t.d(a,{AppProvider:()=>c,f:()=>p,q:()=>y});var r=t(326),n=t(7577),o=t(8069);let s={apiConnected:!1,apiChecking:!0,activeUrl:null,armoires:[],rayons:[],classeurs:[],dossiers:[],intercalaires:[],documents:[],favorites:[],availableTags:[],selectedItemTags:[],loading:{armoires:!0,rayons:!1,classeurs:!1,dossiers:!1,intercalaires:!1,documents:!1,tags:!1},selection:{armoire:null,rayon:null,classeur:null,dossier:null,intercalaire:null,document:null},viewMode:"list",sidebarCollapsed:!1,searchQuery:"",searchResults:[],searchLoading:!1,isSearchActive:!1,modal:{type:null},error:null};function i(e,a){switch(a.type){case"SET_API_STATUS":return{...e,apiConnected:a.payload.connected,apiChecking:a.payload.checking,activeUrl:a.payload.activeUrl||e.activeUrl};case"SET_ARMOIRES":return{...e,armoires:a.payload};case"SET_RAYONS":return{...e,rayons:a.payload};case"SET_CLASSEURS":return{...e,classeurs:a.payload};case"SET_DOSSIERS":return{...e,dossiers:a.payload};case"SET_DOCUMENTS":return{...e,documents:a.payload};case"SET_AVAILABLE_TAGS":return{...e,availableTags:a.payload};case"SET_SELECTED_ITEM_TAGS":return{...e,selectedItemTags:a.payload};case"SET_LOADING":return{...e,loading:{...e.loading,[a.payload.key]:a.payload.value}};case"SELECT_ARMOIRE":return{...e,selection:{armoire:a.payload,rayon:null,classeur:null,dossier:null,intercalaire:null,document:null},rayons:[],classeurs:[],dossiers:[],intercalaires:[],documents:[],selectedItemTags:[],isSearchActive:!1,searchQuery:"",searchResults:[]};case"SELECT_RAYON":return{...e,selection:{...e.selection,rayon:a.payload,classeur:null,dossier:null,intercalaire:null,document:null},classeurs:[],dossiers:[],intercalaires:[],documents:[],selectedItemTags:[]};case"SELECT_CLASSEUR":return{...e,selection:{...e.selection,classeur:a.payload,dossier:null,intercalaire:null,document:null},dossiers:[],intercalaires:[],documents:[],selectedItemTags:[]};case"SELECT_DOSSIER":return{...e,selection:{...e.selection,dossier:a.payload,intercalaire:null,document:null},intercalaires:[],documents:[],selectedItemTags:[]};case"SET_INTERCALAIRES":return{...e,intercalaires:a.payload};case"SELECT_INTERCALAIRE":return{...e,selection:{...e.selection,intercalaire:a.payload,document:null},documents:[],selectedItemTags:[]};case"SELECT_DOCUMENT":return{...e,selection:{...e.selection,document:a.payload}};case"SET_VIEW_MODE":return{...e,viewMode:a.payload};case"TOGGLE_SIDEBAR":return{...e,sidebarCollapsed:!e.sidebarCollapsed};case"SET_SEARCH_QUERY":return{...e,searchQuery:a.payload};case"SET_SEARCH_RESULTS":return{...e,searchResults:a.payload};case"SET_SEARCH_LOADING":return{...e,searchLoading:a.payload};case"SET_SEARCH_ACTIVE":return{...e,isSearchActive:a.payload};case"SHOW_MODAL":return{...e,modal:{type:a.payload.type,data:a.payload.data}};case"HIDE_MODAL":return{...e,modal:{type:null}};case"SET_ERROR":return{...e,error:a.payload};case"CLEAR_ERROR":return{...e,error:null};case"ADD_FAVORITE":if(e.favorites.some(e=>e.id===a.payload.id))return e;return{...e,favorites:[...e.favorites,a.payload]};case"REMOVE_FAVORITE":return{...e,favorites:e.favorites.filter(e=>e.id!==a.payload)};case"SET_FAVORITES":return{...e,favorites:a.payload};default:return e}}let l=(0,n.createContext)(null);function c({children:e}){let[a,t]=(0,n.useReducer)(i,s),c=async()=>{t({type:"SET_LOADING",payload:{key:"armoires",value:!0}});try{let e=await o.W8();t({type:"SET_ARMOIRES",payload:e})}catch(e){t({type:"SET_ERROR",payload:"Impossible de charger les armoires"})}finally{t({type:"SET_LOADING",payload:{key:"armoires",value:!1}})}},y=async()=>{t({type:"SET_LOADING",payload:{key:"tags",value:!0}});try{let e=await o.NJ();t({type:"SET_AVAILABLE_TAGS",payload:e})}catch(e){console.error("Erreur chargement tags:",e)}finally{t({type:"SET_LOADING",payload:{key:"tags",value:!1}})}},p=async e=>{if(t({type:"SELECT_ARMOIRE",payload:e}),e){t({type:"SET_LOADING",payload:{key:"rayons",value:!0}});try{let a=await o.sv(e.id);t({type:"SET_RAYONS",payload:a})}catch(e){t({type:"SET_ERROR",payload:"Impossible de charger les rayons"})}finally{t({type:"SET_LOADING",payload:{key:"rayons",value:!1}})}}},d=async e=>{if(t({type:"SELECT_RAYON",payload:e}),e){t({type:"SET_LOADING",payload:{key:"classeurs",value:!0}});try{let a=await o.sv(e.id);t({type:"SET_CLASSEURS",payload:a})}catch(e){t({type:"SET_ERROR",payload:"Impossible de charger les classeurs"})}finally{t({type:"SET_LOADING",payload:{key:"classeurs",value:!1}})}}},E=async e=>{if(t({type:"SELECT_CLASSEUR",payload:e}),e){t({type:"SET_LOADING",payload:{key:"dossiers",value:!0}});try{let a=await o.sv(e.id);t({type:"SET_DOSSIERS",payload:a})}catch(e){t({type:"SET_ERROR",payload:"Impossible de charger les dossiers"})}finally{t({type:"SET_LOADING",payload:{key:"dossiers",value:!1}})}}},u=async e=>{if(t({type:"SELECT_DOSSIER",payload:e}),e){t({type:"SET_LOADING",payload:{key:"intercalaires",value:!0}}),t({type:"SET_LOADING",payload:{key:"documents",value:!0}});try{let a=await o.sv(e.id),r=a.filter(e=>!e.extension&&"document"!==e.type),n=a.filter(e=>e.extension||"document"===e.type);t({type:"SET_INTERCALAIRES",payload:r}),0===r.length?t({type:"SET_DOCUMENTS",payload:n}):t({type:"SET_DOCUMENTS",payload:[]})}catch(e){t({type:"SET_ERROR",payload:"Impossible de charger le contenu"})}finally{t({type:"SET_LOADING",payload:{key:"intercalaires",value:!1}}),t({type:"SET_LOADING",payload:{key:"documents",value:!1}})}}},S=async e=>{if(t({type:"SELECT_INTERCALAIRE",payload:e}),e){t({type:"SET_LOADING",payload:{key:"documents",value:!0}});try{let a=await o.sv(e.id);t({type:"SET_DOCUMENTS",payload:a})}catch(e){t({type:"SET_ERROR",payload:"Impossible de charger les documents"})}finally{t({type:"SET_LOADING",payload:{key:"documents",value:!1}})}}else t({type:"SET_DOCUMENTS",payload:[]})},T=async e=>{if(t({type:"SELECT_DOCUMENT",payload:e}),e)try{let a=await o.gr(e.id);t({type:"SET_SELECTED_ITEM_TAGS",payload:a})}catch{t({type:"SET_SELECTED_ITEM_TAGS",payload:[]})}else t({type:"SET_SELECTED_ITEM_TAGS",payload:[]})},m=async(e,r,n)=>{try{"armoire"===n?(await o.xu(r),await c()):e&&(await o.L6(e,r),"rayon"===n&&a.selection.armoire?await p(a.selection.armoire):"classeur"===n&&a.selection.rayon?await d(a.selection.rayon):"dossier"===n&&a.selection.classeur?await E(a.selection.classeur):"intercalaire"===n&&a.selection.dossier&&await u(a.selection.dossier)),t({type:"HIDE_MODAL"})}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur de cr\xe9ation"}),e}},_=async(e,r)=>{try{await o.j2(e,r),a.selection.intercalaire?await S(a.selection.intercalaire):a.selection.dossier&&await u(a.selection.dossier),t({type:"HIDE_MODAL"})}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur d'upload"}),e}},R=async(e,r)=>{try{await o.wz(e),"document"===r&&t({type:"REMOVE_FAVORITE",payload:e}),await y(),"armoire"===r?(await c(),t({type:"SELECT_ARMOIRE",payload:null})):"rayon"===r&&a.selection.armoire?await p(a.selection.armoire):"classeur"===r&&a.selection.rayon?await d(a.selection.rayon):"dossier"===r&&a.selection.classeur?await E(a.selection.classeur):"intercalaire"===r&&a.selection.dossier?(await u(a.selection.dossier),t({type:"SELECT_INTERCALAIRE",payload:null})):"document"===r&&(a.selection.intercalaire?await S(a.selection.intercalaire):a.selection.dossier&&await u(a.selection.dossier),t({type:"SELECT_DOCUMENT",payload:null})),t({type:"HIDE_MODAL"})}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur de suppression"}),e}},h=async(e,a,r)=>{try{await o.UE(e,a),await C(),t({type:"HIDE_MODAL"})}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur de renommage"}),e}},A=async(e,a)=>{try{await o.uo(e,a),await C(),t({type:"HIDE_MODAL"})}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur de d\xe9placement"}),e}},f=async()=>{try{return await o.IM()}catch(e){return console.error("Erreur getTree",e),[]}},I=async e=>{if(t({type:"SET_SEARCH_QUERY",payload:e}),e.length<2){t({type:"SET_SEARCH_RESULTS",payload:[]}),t({type:"SET_SEARCH_ACTIVE",payload:!1});return}t({type:"SET_SEARCH_LOADING",payload:!0}),t({type:"SET_SEARCH_ACTIVE",payload:!0});try{let a=await o.yC(e);t({type:"SET_SEARCH_RESULTS",payload:a})}catch(e){t({type:"SET_ERROR",payload:"Erreur de recherche"})}finally{t({type:"SET_SEARCH_LOADING",payload:!1})}},C=async()=>{if(await c(),await y(),a.selection.armoire&&t({type:"SET_RAYONS",payload:await o.sv(a.selection.armoire.id)}),a.selection.rayon&&t({type:"SET_CLASSEURS",payload:await o.sv(a.selection.rayon.id)}),a.selection.classeur&&t({type:"SET_DOSSIERS",payload:await o.sv(a.selection.classeur.id)}),a.selection.dossier){let e=await o.sv(a.selection.dossier.id),r=e.filter(e=>!e.extension&&"document"!==e.type),n=e.filter(e=>e.extension||"document"===e.type);t({type:"SET_INTERCALAIRES",payload:r}),a.selection.intercalaire?t({type:"SET_DOCUMENTS",payload:await o.sv(a.selection.intercalaire.id)}):0===r.length?t({type:"SET_DOCUMENTS",payload:n}):t({type:"SET_DOCUMENTS",payload:[]})}},O=async(e,a)=>{try{await o.ln(e,a),await y(),t({type:"HIDE_MODAL"})}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur de cr\xe9ation"}),e}},w=async e=>{try{await o.Pn(e),await y()}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur de suppression"}),e}},g=async e=>{try{let a=await o.gr(e);t({type:"SET_SELECTED_ITEM_TAGS",payload:a})}catch{t({type:"SET_SELECTED_ITEM_TAGS",payload:[]})}},L=async(e,a)=>{try{let r=await o.wJ(e,a);t({type:"SET_SELECTED_ITEM_TAGS",payload:r.tags}),await y()}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur"}),e}},v=async(e,a)=>{try{let r=await o.jJ(e,a);t({type:"SET_SELECTED_ITEM_TAGS",payload:r.tags}),await y()}catch(e){throw t({type:"SET_ERROR",payload:e instanceof Error?e.message:"Erreur"}),e}},D=async e=>{t({type:"SET_SEARCH_LOADING",payload:!0}),t({type:"SET_SEARCH_ACTIVE",payload:!0}),t({type:"SET_SEARCH_QUERY",payload:`tag:${e}`});try{let a=await o.oH(e);t({type:"SET_SEARCH_RESULTS",payload:a})}catch(e){t({type:"SET_ERROR",payload:"Erreur de filtrage"})}finally{t({type:"SET_SEARCH_LOADING",payload:!1})}},U=async e=>{t({type:"ADD_FAVORITE",payload:e});try{await o.a3(e.id)}catch(a){console.error("Erreur ajout favori:",a),t({type:"REMOVE_FAVORITE",payload:e.id})}},N=async e=>{let r=a.favorites;t({type:"REMOVE_FAVORITE",payload:e});try{await o.Ni(e)}catch(e){console.error("Erreur suppression favori:",e),t({type:"SET_FAVORITES",payload:r})}};return r.jsx(l.Provider,{value:{state:a,dispatch:t,actions:{loadArmoires:c,selectArmoire:p,selectRayon:d,selectClasseur:E,selectDossier:u,selectIntercalaire:S,selectDocument:T,createItem:m,moveItem:A,getTree:f,uploadFiles:_,deleteItem:R,renameItem:h,search:I,clearSearch:()=>{t({type:"SET_SEARCH_QUERY",payload:""}),t({type:"SET_SEARCH_RESULTS",payload:[]}),t({type:"SET_SEARCH_ACTIVE",payload:!1})},refresh:C,loadTags:y,createTag:O,deleteTag:w,loadItemTags:g,addTagToItem:L,removeTagFromItem:v,filterByTag:D,addFavorite:U,removeFavorite:N,isFavorite:e=>a.favorites.some(a=>a.id===e)}},children:e})}function y(){let e=(0,n.useContext)(l);if(!e)throw Error("useApp must be used within an AppProvider");return e}function p(){let{state:e}=y(),{selection:a}=e,t=[];return a.armoire&&t.push({id:a.armoire.id,name:a.armoire.name,level:"armoire"}),a.rayon&&t.push({id:a.rayon.id,name:a.rayon.name,level:"rayon"}),a.classeur&&t.push({id:a.classeur.id,name:a.classeur.name,level:"classeur"}),a.dossier&&t.push({id:a.dossier.id,name:a.dossier.name,level:"dossier"}),a.intercalaire&&t.push({id:a.intercalaire.id,name:a.intercalaire.name,level:"intercalaire"}),a.document&&t.push({id:a.document.id,name:a.document.name,level:"document"}),t}},4128:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>l,metadata:()=>s,viewport:()=>i});var r=t(9510);t(5023);var n=t(8570);let o=(0,n.createProxy)(String.raw`/Users/logan/Sites/ma-ged-perso-frontend/src/lib/store-api.tsx#AppProvider`);(0,n.createProxy)(String.raw`/Users/logan/Sites/ma-ged-perso-frontend/src/lib/store-api.tsx#useApp`),(0,n.createProxy)(String.raw`/Users/logan/Sites/ma-ged-perso-frontend/src/lib/store-api.tsx#useBreadcrumb`);let s={title:"Ma GED Perso",description:"Gestion \xc9lectronique de Documents personnelle",manifest:"/manifest.json",icons:{icon:[{url:"/favicon-16.png",sizes:"16x16",type:"image/png"},{url:"/favicon-32.png",sizes:"32x32",type:"image/png"}],apple:"/apple-touch-icon.png"},appleWebApp:{capable:!0,statusBarStyle:"black-translucent",title:"Ma GED"},formatDetection:{telephone:!1}},i={width:"device-width",initialScale:1,maximumScale:5,userScalable:!0,viewportFit:"cover",themeColor:"#1e3a5f"};function l({children:e}){return(0,r.jsxs)("html",{lang:"fr",children:[(0,r.jsxs)("head",{children:[r.jsx("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),r.jsx("meta",{name:"apple-mobile-web-app-status-bar-style",content:"black-translucent"}),r.jsx("meta",{name:"mobile-web-app-capable",content:"yes"}),r.jsx("link",{rel:"apple-touch-icon",href:"/apple-touch-icon.png"}),r.jsx("script",{src:"/env-config.js",defer:!0})]}),r.jsx("body",{className:"min-h-screen bg-ged-surface",children:r.jsx(o,{children:e})})]})}},5023:()=>{}};